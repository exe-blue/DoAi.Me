const XiaoweiClient=require('./xiaowei-client');const presets=require('./device-presets');async function main(){const xiaowei=new XiaoweiClient('ws://127.0.0.1:22222/');xiaowei.connect();await new Promise(r=>{if(xiaowei.isConnected)return r();xiaowei.on('connected',r);});console.log('Connected\n');const listRes=await xiaowei.list();const devices=listRes.data||[];const serials=devices.map(d=>d.onlySerial||d.serial||d.serialNumber||d.id).filter(Boolean);console.log(`${serials.length} devices\n`);for(const serial of serials){await presets.optimize(xiaowei,serial);}xiaowei.disconnect();console.log('All done');}main().catch(console.error);
